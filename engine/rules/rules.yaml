rules:
  - alias: "Halo: Increase Flower Pot brightness"
    trigger:
      event: "halo.wheel"
      entity_name: "Flower Pot"
      state_change: "clockwise"
    action:
      - service: "hue.step_brightness"
        target:
          type: "light"
          id: "Flower Pot"
        params:
          direction: "up"
          step: "${payload.step}"

  - alias: "Halo: Decrease Flower Pot brightness"
    trigger:
      event: "halo.wheel"
      entity_name: "Flower Pot"
      state_change: "counter_clockwise"
    action:
      - service: "hue.step_brightness"
        target:
          type: "light"
          id: "Flower Pot"
        params:
          direction: "down"
          step: "${payload.step}"

  - alias: "Halo: Toggle Flower Pot Light"
    trigger:
      event: "halo.button"
      entity_name: "Flower Pot"
      state_change: "pressed"
    action:
      - service: "hue.toggle"
        target:
          type: "light"
          id: "Flower Pot"
        params:
          on: "${state.hue.light.flower_pot:on}"

  - alias: "Halo: Update flower_pot button"
    trigger:
      event: "hue.light"
      entity_name: "flower pot"
      state_change: "brightness"
    action:
      - service: "halo.update_button_value"
        target:
          id: "Flower pot"
        params:
          value: "${payload.brightness}"

  - alias: "Halo: Set scene Movie"
    trigger:
      event: "halo.button"
      state_change: "pressed"
    action:
      - service: "hue.set_scene"
        target:
          id: "movie"
        params:
          scene: "movie"

  - alias: "Halo: Play Record"
    trigger:
      event: "halo.button"
      entity_name: "Play Record"
      state_change: "pressed"
    action:
      - service: "bangandolufsen.set_playback_source"
        blocking: true
        target:
          id: "beoconnect_core"
        params:
          source: "lineIn"
      - service: "bangandolufsen.expand_experience"
        target:
          id: "beoconnect_core"
        params:
          to: "stage"

  - alias: "Halo: on connect"
    trigger:
      event: "halo.system"
      state_change: "active"
    condition:
      - entity: "hue.light.flower_pot"
        field: "on"
        in: true
    action:
      - service: "halo.update_button_value"
        target:
          id: "Flower pot"
        params:
          value: "${state.hue.light.flower_pot:brightness}"
          toggle: "${state.hue.light.flower_pot:on}"